<Window x:Class="MSearch.UI.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:MSearch.UI.ViewModels"
        mc:Ignorable="d"
        Title="MinerSearch" Height="700" Width="1000"
        MinHeight="500" MinWidth="800"
        Background="{DynamicResource BackgroundBrush}"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Style="{DynamicResource CardStyle}" Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="MinerSearch" Style="{DynamicResource TitleStyle}"/>
                    <TextBlock Style="{DynamicResource CaptionStyle}">
                        <Run Text="Ð’ÐµÑ€ÑÐ¸Ñ "/><Run Text="{Binding AppVersion}"/> |
                        <Run Text=" Ð‘Ð°Ð·Ð° ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€: "/><Run Text="{Binding SignatureVersion}"/>
                    </TextBlock>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="ðŸŒ™" Command="{Binding ToggleThemeCommand}" 
                            Style="{DynamicResource SecondaryButtonStyle}" 
                            Padding="10,5" Margin="0,0,10,0" ToolTip="Ð¡Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ‚ÐµÐ¼Ñƒ"/>
                    <Button Content="âš™" Command="{Binding OpenSettingsCommand}" 
                            Style="{DynamicResource SecondaryButtonStyle}" 
                            Padding="10,5" Margin="0,0,10,0" ToolTip="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"/>
                    <Button Content="ðŸ“" Command="{Binding OpenQuarantineCommand}" 
                            Style="{DynamicResource SecondaryButtonStyle}" 
                            Padding="10,5" ToolTip="ÐšÐ°Ñ€Ð°Ð½Ñ‚Ð¸Ð½"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Action Panel -->
        <Border Grid.Row="1" Style="{DynamicResource CardStyle}" Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="{Binding StatusText}" Style="{DynamicResource SubtitleStyle}"/>
                    <ProgressBar Value="{Binding ScanProgress}" Maximum="100" 
                                 Style="{DynamicResource ScanProgressBarStyle}" 
                                 Margin="0,10,0,5"/>
                    <TextBlock Style="{DynamicResource CaptionStyle}">
                        <Run Text="Ð¤Ð°Ð¹Ð»Ð¾Ð²: "/><Run Text="{Binding FilesScanned}"/> |
                        <Run Text=" Ð£Ð³Ñ€Ð¾Ð·: "/><Run Text="{Binding ThreatsFound}"/>
                    </TextBlock>
                    <TextBlock Text="{Binding CurrentFile}" Style="{DynamicResource CaptionStyle}" 
                               TextTrimming="CharacterEllipsis" MaxWidth="500"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="ðŸ” ÐŸÐ¾Ð»Ð½Ð¾Ðµ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" 
                            Command="{Binding StartFullScanCommand}"
                            Style="{DynamicResource PrimaryButtonStyle}" 
                            IsEnabled="{Binding IsScanning, Converter={StaticResource InverseBoolConverter}}"
                            Margin="0,0,10,0"/>
                    <Button Content="âš¡ Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" 
                            Command="{Binding StartQuickScanCommand}"
                            Style="{DynamicResource SecondaryButtonStyle}"
                            IsEnabled="{Binding IsScanning, Converter={StaticResource InverseBoolConverter}}"
                            Margin="0,0,10,0"/>
                    <Button Content="â¸ ÐŸÐ°ÑƒÐ·Ð°" 
                            Command="{Binding PauseScanCommand}"
                            Style="{DynamicResource SecondaryButtonStyle}"
                            IsEnabled="{Binding IsScanning}"
                            Margin="0,0,10,0"/>
                    <Button Content="âœ– ÐžÑ‚Ð¼ÐµÐ½Ð°" 
                            Command="{Binding CancelScanCommand}"
                            Style="{DynamicResource DangerButtonStyle}"
                            IsEnabled="{Binding IsScanning}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Threat List -->
        <Border Grid.Row="2" Style="{DynamicResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð½Ñ‹Ðµ ÑƒÐ³Ñ€Ð¾Ð·Ñ‹" 
                           Style="{DynamicResource SubtitleStyle}" Margin="0,0,0,10"/>

                <ListView Grid.Row="1" ItemsSource="{Binding RecentThreats}"
                          Style="{DynamicResource ThreatListStyle}"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{DynamicResource SecondaryBackgroundBrush}" 
                                    CornerRadius="4" Padding="12" Margin="0,4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0" Width="40" Height="40" 
                                            CornerRadius="20" Margin="0,0,12,0"
                                            Background="{DynamicResource DangerBrush}">
                                        <TextBlock Text="âš " FontSize="20" 
                                                   HorizontalAlignment="Center" 
                                                   VerticalAlignment="Center"/>
                                    </Border>

                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding FileName}" 
                                                   Style="{DynamicResource BodyStyle}" 
                                                   FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding Description}" 
                                                   Style="{DynamicResource CaptionStyle}"
                                                   TextTrimming="CharacterEllipsis"/>
                                        <TextBlock Text="{Binding FilePath}" 
                                                   Style="{DynamicResource CaptionStyle}"
                                                   TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                        <Border Background="{DynamicResource DangerBrush}" 
                                                CornerRadius="4" Padding="8,4">
                                            <TextBlock Text="{Binding Type}" 
                                                       Foreground="White" FontSize="12"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <!-- Empty state -->
                <TextBlock Grid.Row="1" Text="Ð£Ð³Ñ€Ð¾Ð· Ð½Ðµ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¾. Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð·Ð°Ñ‰Ð¸Ñ‰ÐµÐ½Ð°."
                           Style="{DynamicResource BodyStyle}"
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           Foreground="{DynamicResource SecondaryTextBrush}"
                           Visibility="{Binding ThreatsFound, Converter={StaticResource ZeroToVisibleConverter}}"/>
            </Grid>
        </Border>

        <!-- Footer -->
        <Border Grid.Row="3" Margin="0,20,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Style="{DynamicResource CaptionStyle}">
                    <Run Text="Â© 2024 MinerSearch. Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ ÑÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¼Ð°Ð¹Ð½ÐµÑ€Ð¾Ð²."/>
                </TextBlock>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="â†» ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ" 
                            Command="{Binding CheckForUpdatesCommand}"
                            Style="{DynamicResource SecondaryButtonStyle}" 
                            Padding="10,5"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
